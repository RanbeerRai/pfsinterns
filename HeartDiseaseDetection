import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# File path to the dataset
file_location = "/full/path/to/heart_disease_uci.csv"
data = pd.read_csv(file_location)

# Remove unnecessary columns
cleaned_data = data.drop(columns=['ca', 'thal', 'slope'])

# Handle missing values
numeric_columns = ['trestbps', 'chol', 'thalach', 'oldpeak']
cleaned_data[numeric_columns] = cleaned_data[numeric_columns].fillna(cleaned_data[numeric_columns].mean())

categorical_columns = ['fbs', 'restecg', 'exang']
cleaned_data[categorical_columns] = cleaned_data[categorical_columns].fillna(cleaned_data[categorical_columns].mode().iloc[0])

# Encode categorical features
encoders = {}
for feature in cleaned_data.select_dtypes(include=['object']).columns:
    encoder = LabelEncoder()
    cleaned_data[feature] = encoder.fit_transform(cleaned_data[feature])
    encoders[feature] = encoder

# Remove additional columns not needed for model training
X = cleaned_data.drop(columns=['num', 'id'])
y = cleaned_data['num']

# Split data into training and testing sets
X_train
